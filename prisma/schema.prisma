generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// F3HIM - F3 Invigorate Identity Model
// Represents a member of F3 (Fitness, Fellowship, Faith)
model F3HIM {
  id String @id @default(cuid())

  // Auth
  firebaseId String @unique
  email      String?

  // Identity
  firstName String?
  lastName  String?
  f3Handle  String? @unique
  photoURL  String?

  // System
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relations
  attendanceRecords AttendanceRecord[]
  effortRecords     EffortRecord[]
  weeklyReflections WeeklyReflection[] // deprecated UX, keep table
  selfReportEntries SelfReportEntry[]   // deprecated UX, keep table

  @@map("f3_hims")
}

model AttendanceRecord {
  id      String   @id @default(cuid())
  f3HIMId String
  aoId    String
  date    DateTime
  source  AttendanceSource
  f3HIM   F3HIM @relation(fields: [f3HIMId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("attendance_records")
}

enum AttendanceSource {
  BACKBLAST
  SELF
}

model EffortRecord {
  id          String   @id @default(cuid())
  f3HIMId     String
  date        DateTime
  calories    Int?
  durationSec Int?
  calPerMin   Float?
  f3HIM       F3HIM @relation(fields: [f3HIMId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("effort_records")
}

model WeeklyReflection {
  id        String   @id @default(cuid())
  f3HIMId   String
  date      DateTime @default(now())
  mood      String?
  wins      String?
  struggles String?
  intention String?
  f3HIM     F3HIM @relation(fields: [f3HIMId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("weekly_reflections")
}

model SelfReportEntry {
  id          String            @id @default(cuid())
  f3HIMId     String
  date        DateTime          @default(now())
  category    SelfReportCategory
  note        String?
  f3HIM       F3HIM @relation(fields: [f3HIMId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("self_report_entries")
}

enum SelfReportCategory {
  FELLOWSHIP
  SERVICE
  MARRIAGE_FAMILY
  DIET_QUEEN
  MENTAL_HEALTH
  SPIRITUAL
}

